# steam_spec_check
PC ìŠ¤í™(OS, CPU, GPU ë“±)ì„ ì…ë ¥ë°›ì•„ ê° ê¶Œì¥ ì‚¬ì–‘, ìµœì†Œ ì‚¬ì–‘ì„ ë§Œì¡±ì‹œí‚¤ëŠ” Steam ê²Œì„ì„ ê²€ìƒ‰í•˜ëŠ” API ì„œë²„

## ğŸ‰ í”„ë¡œì íŠ¸ ì†Œê°œ
ì„¸ê³„ ìµœëŒ€ ê·œëª¨ì˜ ì „ì ì†Œí”„íŠ¸ì›¨ì–´ ìœ í†µë§ì¸ **Steam**ì—ëŠ” ì•½ 5ë§Œ ê°œê°€ ë„˜ëŠ” ê²Œì„ë“¤ì´ ìˆìŠµë‹ˆë‹¤.

Steam ë‚´ì—ëŠ” ì´ ìˆ˜ë§ì€ ê²Œì„ë“¤ ì¤‘ ì·¨í–¥ì— ë§ëŠ” ê²Œì„ì„ ê²€ìƒ‰í•˜ê¸° ìœ„í•œ í•„í„°ê°€ ì¡´ì¬í•˜ì§€ë§Œ,
**ì‹œìŠ¤í…œ ìš”êµ¬ ì‚¬í•­ì„ ê¸°ì¤€ìœ¼ë¡œ í•œ í•„í„°ë§**ì€ ì—†ìŠµë‹ˆë‹¤.

ì´ì œëŠ” ë¶€ë‹´ìŠ¤ëŸ¬ìš´ GPU ê°€ê²©ê³¼ ê¾¸ì¤€íˆ ì˜¬ë¼ê°€ëŠ” ê·¸ë˜í”½ ìš”êµ¬ì‚¬ì–‘ìœ¼ë¡œ ì¸í•´
**ìµœì‹  ê²Œì„ë“¤ì˜ ê¶Œì¥ì‚¬ì–‘ì„ ë§Œì¡±ì‹œí‚¤ê¸°ê°€ ë”ë”ìš± ì–´ë ¤ì›Œì¡ŒìŠµë‹ˆë‹¤**.

ì´ì— ì‹œìŠ¤í…œ ì‚¬ì–‘ì„ ê¸°ì¤€ìœ¼ë¡œ í•œ í•„í„°ë§ì˜ í•„ìš”ì„±ì„ ëŠë¼ê²Œ ë˜ì–´ í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ê¸°íší•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

**ë³¸ í”„ë¡œì íŠ¸ëŠ” ì‚¬ìš©ìì˜ PC ìŠ¤í™(OS, CPU, GPU ë“±)ì„ ì…ë ¥ë°›ì•„
ê° ê¶Œì¥ ì‚¬ì–‘, ìµœì†Œ ì‚¬ì–‘ì„ ë§Œì¡±ì‹œí‚¤ëŠ” ê²Œì„ì„ ê²€ìƒ‰í•˜ëŠ” API ì„œë²„ë¥¼ êµ¬ì¶•í•©ë‹ˆë‹¤.**

## ğŸ‘€ í”„ë¡œì íŠ¸ ì •ë³´
### ê°œë°œ ìŠ¤íƒ
<img alt="Html" src ="https://img.shields.io/badge/NODEJS-339933.svg?&style=for-the-badge&logo=Node.js&logoColor=white"/> <img alt="Html" src ="https://img.shields.io/badge/EXPRESS-000000.svg?&style=for-the-badge&logo=Express&logoColor=white"/>

## ğŸ« API ë ˆí¼ëŸ°ìŠ¤
### ì„¤ëª…
ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ” Steam ê²Œì„ ëª©ë¡ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

### ìš”ì²­ URL
```http://ec2-13-209-21-60.ap-northeast-2.compute.amazonaws.com:4000/games```

### í”„ë¡œí† ì½œ
HTTPS

### HTTP ë©”ì„œë“œ
POST

### íŒŒë¼ë¯¸í„°
<img src="https://github.com/SD-PARK/steam_spec_check/assets/97375357/abade43f-4af2-4ea7-b205-4e3370dc2861" valign="bottom"/>
<details>
<summary><img src="https://github.com/SD-PARK/steam_spec_check/assets/97375357/7f8c2bcb-82df-4e1d-b03b-bbdb26a45757" valign="bottom"></summary>
<div markdown="1">
<img src="https://github.com/SD-PARK/steam_spec_check/assets/97375357/f05954ee-4aa9-4d1b-b3cb-7c74b44be5b3" valign="bottom"/>
</div></details>

### ì°¸ê³  ì‚¬í•­
ì¼ë¶€ íŒŒë¼ë¯¸í„°ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì½”ë“œ ê°’ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

<details><summary>ì–¸ì–´ ëª©ë¡</summary>
<div markdown="1">
<img src="https://github.com/SD-PARK/steam_spec_check/assets/97375357/5474221d-f489-4c63-8220-0ca1e1f88d84">
</div></details>

<details><summary>ì¹´í…Œê³ ë¦¬ ëª©ë¡</summary>
<div markdown="1">
<img src="https://github.com/SD-PARK/steam_spec_check/assets/97375357/4a295468-bc8f-4eb8-813e-925a0c864109">
</div></details>

<details><summary>ì¥ë¥´ ëª©ë¡</summary>
<div markdown="1">
<img src="https://github.com/SD-PARK/steam_spec_check/assets/97375357/d13d198a-fc98-4d9f-85d1-4cd2227bf004">
</div></details>

[CPU ëª©ë¡](https://www.cpubenchmark.net/cpu_list.php)

[GPU ëª©ë¡](https://www.videocardbenchmark.net/gpu_list.php)

### ì½”ë“œ ì˜ˆì œ
```json
{
    "factor": "magicka",
    "display": 1,
    "recommended": true,
    "languages": ["English"],
    "categories": [2, 28],
    "genres": [1],
    "specs": {
        "os": "10",
        "processor": "Intel Core i9-10850K @ 3.60GHz",
        "memory": 8192,
        "graphics": "GeForce RTX 4090",
        "storage": 204800
    }
}
```

### ì‘ë‹µ
ì‘ë‹µì— ì„±ê³µí•˜ë©´ ê²°ê´ê°’ì„ JSON í˜•íƒœë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

![response](https://github.com/SD-PARK/steam_spec_check/assets/97375357/1781d1e8-324c-4f4e-8e5e-4073ab2ae12f)

<details><summary><h3>ì‘ë‹µ ì˜ˆ</h3></summary>
<div markdown="1">

``` json
[
    {
        "name": "Magicka 2: Ice, Death and Fury",
        "id": 414651,
        "is_free": false,
        "supported_languages": ["English", "French", "Italian", "German", "Spanish - Spain", "Polish", "Portuguese - Brazil", "Russian"],
        "header_image": "https://cdn.akamai.steamstatic.com/steam/apps/414651/header.jpg?t=1589892038",
        "requirements": {
            "minimum": {
                "OS": {"version": "7", "bit": "64"},
                "Memory": 2048,
                "Graphics": {"name": "Radeon HD 5850", "value": 1978},
                "Storage": 3072
            },
            "recommended": {
                "OS": {"version": "", "bit": "64"},
                "Memory": 4096,
                "Graphics": {"name": "Radeon HD 6670", "value": 734},
                "Storage": 7168
            }
        },
        "categories": [
            {"id": 2, "description": "Single-player"}, 
            {"id": 1, "description": "Multi-player"}, 
            {"id": 9, "description": "Co-op"}, 
            {"id": 24, "description": "Shared/Split Screen"}, 
            {"id": 21, "description": "Downloadable Content"}, 
            {"id": 22, "description": "Steam Achievements"}, 
            {"id": 28, "description": "Full controller support"}, 
            {"id": 29, "description": "Steam Trading Cards"}
        ],
        "genres": [{"id": 1, "description": "Action"}, {"id": 25, "description": "Adventure"}]
    }
]
```
</div></details>

## âœ¨ ì£¼ìš” ì½”ë“œ
<details><summary><h4>src/apps/benchmarkCrawler.js</h4></summary>
<div markdown="1">

```js
async function updateData(url, fileName) {
    try {
        const html = await axios.get(url);
        const ulList = [];

        const $ = cheerio.load(html.data);

        const bodyList = $('tbody > tr');
        bodyList.each((i, element) => {
            const valueText = $(element).find('td:nth-child(2)').text();
            const value = parseInt(valueText.replace(/,/g, ''));
            ulList.push({
                name: $(element).find('td:nth-child(1) > a').text(),
                value: value
            });
        });

        await useJSON.writeJSON(ulList, fileName);
    } catch {
        console.error(error);
    }
}

module.exports = {
    async cpuUpdate() {
        await updateData('https://www.cpubenchmark.net/cpu_list.php', 'cpuData.json');
    },
    async gpuUpdate() {
        await updateData('https://www.videocardbenchmark.net/gpu_list.php', 'gpuData.json');
    }
}
```
</div></details>

ë²¤ì¹˜ë§ˆí¬ ì ìˆ˜ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” PassMark ì‚¬ì´íŠ¸ì—ì„œ ëª¨ë“  í•˜ë“œì›¨ì–´ì˜ ì´ë¦„ê³¼ ë²¤ì¹˜ë§ˆí¬ ì ìˆ˜ë¥¼ **í¬ë¡¤ë§**í•´ **JSON í˜•íƒœë¡œ ì €ì¥**í•©ë‹ˆë‹¤.

í•´ë‹¹ ë°ì´í„°ëŠ” ì¶”í›„ **ì‚¬ìš©ì PC ì„±ëŠ¥ì™€ ê° ê²Œì„ë³„ ìš”êµ¬ ì„±ëŠ¥ ê°„ì˜ ë¹„êµ**ë¥¼ ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.

---
<details><summary><h4>src/apps/gameDetailsFetcher.js</h4></summary>
<div markdown="1">

```js
const batchSize = 200; // í•œ ë²ˆì— ì²˜ë¦¬í•  ê²Œì„ ê°œìˆ˜
const interval = (5 * 60 * 1000) + 1000; // API í˜¸ì¶œ ê°„ê²© (ë°€ë¦¬ì´ˆ ë‹¨ìœ„)
let appIDs = []; // ëª¨ë“  ê²Œì„ì˜ app ID
let appNames = []; // ëª¨ë“  ê²Œì„ì˜ ì´ë¦„
let appInfos = []; // ìƒˆë¡œ ì €ì¥í•  ê²Œì„ì˜ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

/**
 * ê²Œì„ ë°ì´í„° ì‘ì„± ì‘ì—…ì„ ì´ì–´ì„œ ì§„í–‰í•©ë‹ˆë‹¤. 'findOmission()' í•¨ìˆ˜ë¥¼ í†µí•´ ì•„ì§ ì‘ì„±ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ê³ ,
 * ì‘ì„±ëœ ê²Œì„ ë°ì´í„° íŒŒì¼ì´ ì €ì¥ë˜ì–´ ìˆëŠ” JSON íŒŒì¼ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
 * ì´í›„ ì•„ì§ ì‘ì„±ë˜ì§€ ì•Šì€ ê²Œì„ë“¤ì˜ ì •ë³´ë¥¼ APIë¥¼ í†µí•´ ê°€ì ¸ì™€ JSON íŒŒì¼ì— ì¶”ê°€í•©ë‹ˆë‹¤.
 */
const continueWritingGameData = async () => {
    // ì•„ì§ ì‘ì„±ë˜ì§€ ì•Šì€ ê²Œì„ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
    const games = await findOmission();
    appIDs = games.map(game => game.appid);
    appNames = games.map(game => game.name);
    // ì‘ì„±ëœ ê²Œì„ ì„¸ë¶€ ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ” ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
    appInfos = await useJSON.readJSON('gameData.json');
    
    // 'processNextBatch()' í•¨ìˆ˜ë¥¼ í†µí•´ ì‘ì„±ë˜ì§€ ì•Šì€ ê²Œì„ë“¤ì˜ ì„¸ë¶€ ì •ë³´ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
    if (appIDs.length > 0) {
        console.log('Continue indexing from', appIDs[0]);
        await processNextBatch(0).then(async () => { await useJSON.writeJSON(appInfos, 'gameData.json'); });
    } else {
        console.log('GameData Upload Completed!');
    }
}

/**
 * ì¼ê´„ ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ì…ë‹ˆë‹¤.
 * ì‹œì‘ ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¼ê´„ ì²˜ë¦¬í•  ê²Œì„ IDë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ, APIë¥¼ í˜¸ì¶œí•˜ì—¬ ê²Œì„ ì„¸ë¶€ ì •ë³´ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
 * ì´í›„ ë‹¤ìŒ ì¼ê´„ ì²˜ë¦¬ë¥¼ ì˜ˆì•½í•˜ê³ , ëª¨ë“  í˜¸ì¶œì´ ì™„ë£Œë˜ë©´ ì¶”ì¶œëœ ì •ë³´ë¥¼ JSON íŒŒì¼ì— ì €ì¥í•©ë‹ˆë‹¤.
 * 
 * !!í˜¸ì¶œí•˜ê¸° ì „ ë°˜ë“œì‹œ appIDs, appNames ë³€ìˆ˜ë¥¼ ì´ˆê¸°í™”í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.
 *
 * @param {number} startIndex - ì¼ê´„ ì²˜ë¦¬ì˜ ì‹œì‘ ì¸ë±ìŠ¤
 * @returns {Promise<Array>}
 */
async function processNextBatch(startIndex) {
    const endIndex = Math.min(startIndex + batchSize, appIDs.length);
    const batchIDs = appIDs.slice(startIndex, endIndex);
    
    // ë‹¤ìŒ í˜¸ì¶œì„ ì˜ˆì•½í•©ë‹ˆë‹¤. í˜¸ì¶œì„ ë§ˆì¹˜ë©´ JSON íŒŒì¼ì— ì €ì¥í•©ë‹ˆë‹¤.
    if (endIndex < appIDs.length) {
        setTimeout(() => processNextBatch(endIndex).then(async () => {
            await useJSON.writeJSON(appInfos, 'gameData.json');
        }), interval);
    }

    // 'fetchGameDetails()' í•¨ìˆ˜ë¥¼ í†µí•´ APIë¥¼ í˜¸ì¶œí•´ ê²Œì„ ì„¸ë¶€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™€ appInfos ë³€ìˆ˜ì— ì €ì¥í•©ë‹ˆë‹¤.
    const promises = batchIDs.map(id => fetchGameDetails(id));
    return Promise.all(promises);
}
```
    
</div></details>
    
'steamapi' ëª¨ë“ˆì„ í†µí•´ **Steam ë‚´ ê²Œì„ë“¤ì˜ ì„¸ë¶€ ë°ì´í„°**ë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤.

ì „ì²´ ê²Œì„ ë¦¬ìŠ¤íŠ¸ëŠ” í•œ ë²ˆì— ìš”ì²­í•  ìˆ˜ ìˆì§€ë§Œ,

ê²Œì„ ì„¸ë¶€ ë°ì´í„°(ì‹œìŠ¤í…œ ìš”êµ¬ ì‚¬í•­, ì¹´í…Œê³ ë¦¬ ë“±)ëŠ” **5ë¶„ì— 200ë²ˆ**ìœ¼ë¡œ API í˜¸ì¶œì— ì œí•œì´ ìˆê¸° ë•Œë¬¸ì—

ë¯¸ë¦¬ ì „ì²´ ê²Œì„ ë¦¬ìŠ¤íŠ¸ë¥¼ JSON í˜•íƒœë¡œ ì €ì¥í•´ë‘” ë’¤, í•´ë‹¹ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ **200ê°œ ì”© ë‚˜ëˆ„ì–´** ê²Œì„ì˜ ì„¸ë¶€ ë°ì´í„°ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

---
<details><summary><h4>src/routes/_controller/apiController.js</h4></summary>
<div markdown="1">

```js
const apiController = {
    validateInputMiddleware: (req, res, next) => {
        const { factor, display, recommended, languages, categories, genres, specs } = req.body;
        // factor
        if (factor !== undefined && typeof factor !== 'string') {
            return res.status(400).json({ error: 'Invalid factor. Factor should be a string.' });
        }
        // display
        if (display !== undefined && typeof display !== 'number') {
            return res.status(400).json({ error: 'Invalid display. Display should be a number.' });
        }
        // recommended
        if (recommended !== undefined && typeof recommended !== 'boolean') {
            return res.status(400).json({ error: 'Invalid recommended. Recommended should be a boolean.' });
        }
        // languages
        if (languages !== undefined) {
            if (!Array.isArray(languages)) {
                return res.status(400).json({ error: 'Invalid languages. Languages should be an array.' });
            }
            if (!languages.every((lang) => typeof lang === 'string')) {
                return res.status(400).json({ error: 'Invalid languages. All elements in languages array should be strings.' });
            }
        }
        // categories
        if (categories !== undefined) {
            if (!Array.isArray(categories)) {
                return res.status(400).json({ error: 'Invalid categories. Categories should be an array.' });
            }
            if (!categories.every((category) => typeof category === 'number')) {
                return res.status(400).json({ error: 'Invalid categories. All elements in categories array should be numbers.' });
            }
        }
        // genres
        if (genres !== undefined) {
            if (!Array.isArray(genres)) {
                return res.status(400).json({ error: 'Invalid genres. Genres should be an array.' });
            }
            if (!genres.every((genre) => typeof genre === 'number')) {
                return res.status(400).json({ error: 'Invalid genres. All elements in genres array should be numbers.' });
            }
        }
        // specs
        if (specs !== undefined) {
            if (typeof specs !== 'object' || specs === null) {
                return res.status(400).json({ error: 'Invalid specs. Specs should be an object.' });
            }
            // os
            const windowsVersions = ["Vista", "7", "8", "8.1", "10", "11"];
            if (specs.os !== undefined && !windowsVersions.includes(specs.os)) {
                return res.status(400).json({ error: 'Invalid os. OS should only write the version of Windows.' });
            }
            // processor
            if (specs.processor !== undefined && !cpuDict.has(specs.processor)) {
                return res.status(400).json({ error: 'Invalid processor. Processor must have a specified value. Please refer to the site: https://www.cpubenchmark.net/cpu_list.php' });
            }
            // memory
            if (specs.memory !== undefined && typeof specs.memory !== 'number') {
                return res.status(400).json({ error: 'Invalid memory. Memory should be a number.' });
            }
            // graphics
            if (specs.graphics !== undefined && !gpuDict.has(specs.graphics)) {
                return res.status(400).json({ error: 'Invalid graphics. Graphics must have a specified value. Please refer to the site: https://www.videocardbenchmark.net/gpu_list.php' });
            }
            // storage
            if (specs.storage !== undefined && typeof specs.storage !== 'number') {
                return res.status(400).json({ error: 'Invalid storage. Storage should be a number.' });
            }
        }
        
        next();
    }
}
```
</div></details>

**ìš”ì²­ ë³¸ë¬¸**ì— ëŒ€í•œ **ìœ íš¨ì„± ê²€ì‚¬**ë¥¼ ì§„í–‰í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ì…ë‹ˆë‹¤.

ì…ë ¥ë°›ì€ ê°’ì´ ìœ íš¨í•˜ì§€ ì•Šì„ ê²½ìš°, **ì˜¤ë¥˜ ì‘ë‹µì„ ë°˜í™˜**í•©ë‹ˆë‹¤.

ì˜¤ë¥˜ ì‘ë‹µì€ JSON í˜•ì‹ìœ¼ë¡œ `{ error: 'ì˜¤ë¥˜ ë©”ì‹œì§€' }`ì™€ ê°™ì´ êµ¬ì„±ë˜ë©°, ìƒíƒœ ì½”ë“œ 400ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.

ìœ íš¨ì„± ê²€ì‚¬ í•­ëª©ì„ ì¶©ì¡±í•˜ëŠ” ê²½ìš°, 'next()' í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ **ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ë¡œ ì´ë™**í•©ë‹ˆë‹¤.

---

## ğŸ’¬ ì‹¤í–‰ ë°©ë²•

### Requirements
For building and running the applicationyou need:
- Node.js (v16 or above)
- npm (Node Package Manager)

### Installation

1. Clone the repository:
```bash
$ git clone https://github.com/SD-PARK/steam_spec_check.git
```

2. Navigate to the project directory:
```bash
$ cd steam_spec_check
```

3. Install the dependencies:
```bash
$ npm install
```

### Configuration
To run this project successfully, you need to add the STEAM_API_KEY to the .env file. The STEAM_API_KEY is obtained from the Steam website. Here's how you can add the Steam API Key to the .env file:

1. Sign up and log in to the Steam Developer site.

2. To obtain the Steam API Key, follow these steps:
   - Go to the developer page (https://steamcommunity.com/dev/apikey).
   - Click on "Register a New Web API Key".
   - Enter an application name, agree to the terms, and click on "Register".
   - A Steam API Key will be generated. Save this key in a secure location.

3. Create a `.env` file in the project root directory.

4. Open the `.env` file in a text editor and write the following:

   ```plaintext
   STEAM_API_KEY=Enter_Your_Steam_API_Key_Here
    ```

    Replace Enter_Your_Steam_API_Key_Here with the actual Steam API Key you obtained.

    Save the .env file.

    Now, when you run the API server, the .env file will be automatically loaded, and you can access the Steam API Key using process.env.STEAM_API_KEY.

### Usage
To start the API Server, run the following command:
```bash
$ npm start
```
The server will start listening on the specified port (default: 4000) and you will see the message `Server listen on PORT ${PORT}` in the console.

### API Endpoints
GET `/update`: Update the list of new games on Steam.
    
POST `/games`: Submits user PC specifications and retrieves a list of compatible games.

Please refer to the [API documentation](#íŒŒë¼ë¯¸í„°) for more details on each endpoint and the expected request and response formats.
